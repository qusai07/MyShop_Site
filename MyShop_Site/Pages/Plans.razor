@page "/plans"
@using MyShop_Site.Models
@using MyShop_Site.Services
@inject PlanService PlanService
@inject NavigationManager Navigation

<PageTitle>Subscription Plans - MyShop</PageTitle>

<div class="container my-5">
    <div class="text-center mb-5">
        <h1 class="display-4">Choose Your Plan</h1>
        <p class="lead">Select the perfect plan for your business needs</p>
    </div>

    <div class="row justify-content-center">
        @if (plans != null && plans.Any())
        {
            @foreach (var plan in plans)
            {
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="plan-card @(plan.IsPopular ? "popular" : "")">
                        @if (plan.IsPopular)
                        {
                            <div class="popular-badge">Most Popular</div>
                        }
                        <div class="plan-header">
                            <h3>@plan.Name</h3>
                            <div class="plan-price">
                                <span class="currency">$</span>
                                <span class="amount">@plan.MonthlyPrice.ToString("F0")</span>
                                <span class="period">/month</span>
                            </div>
                        </div>
                        <div class="plan-features">
                            @foreach (var feature in plan.Features)
                            {
                                <div class="feature-item">
                                    <i class="oi oi-check text-success"></i>
                                    @feature
                                </div>
                            }
                        </div>
                        <div class="plan-footer">
                            <button class="btn btn-primary btn-lg w-100" @onclick="() => SelectPlan(plan.Id)">
                                Choose @plan.Name
                            </button>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="col-12 text-center">
                <h3>No plans available</h3>
                <p class="text-muted">Check back later for subscription options!</p>
            </div>
        }
    </div>
</div>

@code {
    private List<Plan>? plans;

    protected override void OnInitialized()
    {
        plans = PlanService.GetAllPlans();
    }

    private void SelectPlan(int planId)
    {
        Navigation.NavigateTo($"/payment?planId={planId}");
    }
}